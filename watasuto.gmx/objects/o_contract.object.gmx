<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>imeSelected = false;
imeInput = '';
imeHangul = true;

// hardcoded IME details
chars = 'ㅁㅠㅊㅇㄷㄹㅎㅗㅑㅓㅏㅣㅡㅜㅐㅔㅂㄱㄴㅅㅕㅍㅈㅌㅛㅋ';
schars = 'ㅁㅠㅊㅇㄸㄹㅎㅗㅑㅓㅏㅣㅡㅜㅒㅖㅃㄲㄴㅆㅕㅍㅉㅌㅛㅋ';
choseong = 'ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ';
jungseong = 'ㅏㅐㅑㅒㅓㅔㅕㅖㅗㅘㅙㅚㅛㅜㅝㅞㅟㅠㅡㅢㅣ';
jongseong = 'ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ';
sp[0] = 192; sp[1] = 189; sp[2] = 187; sp[3] = 220; sp[4] = 219; sp[5] = 221; sp[6] = 186; sp[7] = 222; sp[8] = 188; sp[9] = 190; sp[10] = 191; sp[11] = 111; sp[12] = 106; sp[13] = 109; sp[14] = 107; sp[15] = 110;
jong2cho[0] = 0; jong2cho[1] = 1; jong2cho[2] = -1; jong2cho[3] = 2; jong2cho[4] = -1; jong2cho[5] = -1; jong2cho[6] = 3; jong2cho[7] = 5; jong2cho[8] = -1; jong2cho[9] = -1; jong2cho[10] = -1; jong2cho[11] = -1; jong2cho[12] = -1; jong2cho[13] = -1; jong2cho[14] = -1; jong2cho[15] = 6; jong2cho[16] = 7; jong2cho[17] = -1; jong2cho[18] = 9; jong2cho[19] = 10; jong2cho[20] = 11; jong2cho[21] = 12; jong2cho[22] = 14; jong2cho[23] = 15; jong2cho[24] = 16; jong2cho[25] = 17; jong2cho[26] = 18;
cjung[0, 0] = 8; cjung[0, 1] = 0; cjung[0, 2] = 9;
cjung[1, 0] = 8; cjung[1, 1] = 1; cjung[1, 2] = 10;
cjung[2, 0] = 8; cjung[2, 1] = 20; cjung[2, 2] = 11;
cjung[3, 0] = 13; cjung[3, 1] = 4; cjung[3, 2] = 14;
cjung[4, 0] = 13; cjung[4, 1] = 5; cjung[4, 2] = 15;
cjung[5, 0] = 13; cjung[5, 1] = 20; cjung[5, 2] = 16;
cjung[6, 0] = 18; cjung[6, 1] = 20; cjung[6, 2] = 19;
cjong[0, 0] = 1; cjong[0, 1] = 19; cjong[0, 2] = 3;
cjong[1, 0] = 4; cjong[1, 1] = 22; cjong[1, 2] = 5;
cjong[2, 0] = 4; cjong[2, 1] = 27; cjong[2, 2] = 6;
cjong[3, 0] = 8; cjong[3, 1] = 1; cjong[3, 2] = 9;
cjong[4, 0] = 8; cjong[4, 1] = 16; cjong[4, 2] = 10;
cjong[5, 0] = 8; cjong[5, 1] = 17; cjong[5, 2] = 11;
cjong[6, 0] = 8; cjong[6, 1] = 19; cjong[6, 2] = 12;
cjong[7, 0] = 8; cjong[7, 1] = 25; cjong[7, 2] = 13;
cjong[8, 0] = 8; cjong[8, 1] = 26; cjong[8, 2] = 14;
cjong[9, 0] = 8; cjong[9, 1] = 27; cjong[9, 2] = 15;
cjong[10, 0] = 17; cjong[10, 1] = 19; cjong[10, 2] = 18;
spc = '`-=\[];' + "'" + ',.//*-+';
sps = '~_+|{}:"&lt;&gt;?';
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var
   shift = keyboard_check(vk_shift),
   hangul = keyboard_check_pressed(vk_tab),
   backspace = keyboard_check_pressed(vk_backspace);

if(hangul) {
   imeHangul = !imeHangul;
   imeSelected = false;
}

if(imeHangul) { // 한글
   var
      decho, dejung, dejong,
      deord, complete;
   if(imeSelected) { // 마지막 글자 해체
      var sel = string_char_at(imeInput, string_length(imeInput));
      deord = ord(sel);
      complete = deord &gt;= $ac00 &amp;&amp; deord &lt;= $d7a3;
      if(complete) {
         decho = (deord - $ac00) div 588;
         dejung = (deord - $ac00)%588 div 28;
         dejong = (deord - $ac00)%28;
      }
   }
   
   for(var i = 65; i &lt; 91; i++) {
      if(!keyboard_check_pressed(i))
         continue;
      
      var asHangul, del = false, add = '';
      // 낱자로 변환
      if(shift)
         asHangul = string_char_at(schars, i - 64);
      else
         asHangul = string_char_at(chars, i - 64);
      
      // 조합 판정 시작
      if(imeSelected) // 조합
         if(!complete) { // 낱자?
            var
               destcho = string_pos(sel, choseong) - 1,
               destjung = string_pos(sel, jungseong) - 1,
               destjong = string_pos(sel, jongseong),
               srccho = string_pos(asHangul, choseong) - 1,
               srcjung = string_pos(asHangul, jungseong) - 1,
               srcjong = string_pos(asHangul, jongseong);
            if(destjung != -1 &amp;&amp; srcjung != -1) { // 모음 합자?
               for(var j = 0; j &lt; 8; j++)
                  if(j == 7)
                     add = asHangul;
                  else if(cjung[j, 0] == destjung &amp;&amp; cjung[j, 1] == srcjung) {
                     del = true;
                     add = string_char_at(jungseong, cjung[j, 2]);
                     break;
                  }
            } else if(destcho != -1 &amp;&amp; srcjung != -1) { // 음절로 합자?
               del = true;
               add = chr($ac00 + destcho*588 + srcjung*28);
            } else if(srcjong &amp;&amp; destjong) { // 자음 합자?
               for(var j = 0; j &lt; 12; j++)
                  if(j == 11)
                     add = asHangul;
                  else if(cjong[j, 0] == destjong &amp;&amp; cjong[j, 1] == srcjong) {
                     del = true;
                     add = string_char_at(jongseong, cjong[j, 2]);
                     break;
                  }
            } else
               add = asHangul;
         } else {
            var
               srccho = string_pos(asHangul, choseong) - 1,
               srcjung = string_pos(asHangul, jungseong) - 1,
               srcjong = string_pos(asHangul, jongseong);
            if(dejong) {
               if(srcjung != -1) { // 자음 + 모음
                  for(var j = 0; j &lt; 12; j++)
                     if(j == 11) { // 일반 도깨비불?
                        del = true;
                        add =
                           chr($ac00 + decho*588 + dejung*28) +
                           chr($ac00 + jong2cho[dejong - 1]*588 + srcjung*28);
                     } else if(cjong[j, 2] == dejong) { // 합자 도깨비불?
                        del = true;
                        add =
                           chr($ac00 + decho*588 + dejung*28 + cjong[j, 0]) +
                           chr($ac00 + jong2cho[cjong[j, 1] - 1]*588 + srcjung*28);
                        break;
                     }
               } else for(var j = 0; j &lt; 12; j++) // 자음 + 자음
                  if(j == 11)
                     add = asHangul;
                  else if(cjong[j, 0] == dejong &amp;&amp; cjong[j, 1] == srcjong) { // 자음 합자?
                     del = true;
                     add = chr($ac00 + decho*588 + dejung*28 + cjong[j, 2]);
                     break;
                  }
            } else if(srcjung != -1) { // 모음 + 모음
               for(var j = 0; j &lt; 8; j++)
                  if(j == 7)
                     add = asHangul;
                  else if(cjung[j, 0] == dejung &amp;&amp; cjung[j, 1] == srcjung) { // 모음 합자?
                     del = true;
                     add = chr($ac00 + decho*588 + cjung[j, 2]*28);
                     break;
                  }
            } else if(srcjong) { // 모음 + 종성?
               del = true;
               add = chr($ac00 + decho*588 + dejung*28 + srcjong);
            } else // 모음 + 초성
               add = asHangul;
         }
      else
         add = asHangul;
      // 조합 판정 끝
      
      imeSelected = true;
      // 문자열 업데이트
      if(del)
         imeInput = string_delete(imeInput, string_length(imeInput), 1) + add;
      else
         imeInput += add;
      
      // 마지막 문자 업데이트
      var sel = string_char_at(imeInput, string_length(imeInput));
      deord = ord(sel);
      complete = deord &gt;= $ac00 &amp;&amp; deord &lt; $d7a3;
      if(complete) {
         decho = (deord - $ac00) div 588;
         dejung = (deord - $ac00)%588 div 28;
         dejong = (deord - $ac00)%28;
      }
   }
} else for(var i = 65; i &lt; 91; i++)
   if(keyboard_check_pressed(i)) {
      imeSelected = false;
      imeInput += chr(i + 32*!shift);
   }

if(keyboard_check_pressed(vk_space)) {
   imeSelected = false;
   imeInput += ' ';
}

for(var i = 0; i &lt; 10; i++) { // 숫자
   if(keyboard_check_pressed(48 + i)) {
      imeSelected = false;
      if(shift) {
         if(i != 3)
            imeInput += string_char_at(')!@ $%^&amp;*(', i + 1);
      } else
         imeInput += string(i);
   }
   if(keyboard_check_pressed(96 + i) &amp;&amp; !shift) {
      imeSelected = false;
      imeInput += string(i);
   }
}

for(var i = 0; i &lt; 16; i++) // 특수문자
   if(keyboard_check_pressed(sp[i]))
      if(shift) {
         if(i &lt; 11) {
            imeSelected = false;
            imeInput += string_char_at(sps, i + 1);
         }
      } else {
         imeSelected = false;
         imeInput += string_char_at(spc, i + 1);
      }

if(backspace &amp;&amp; imeInput != '') {
   var add = '';
   if(imeSelected) { // 조합 풀기
      var
         sel = string_char_at(imeInput, string_length(imeInput)),
         deord = ord(sel),
         complete = deord &gt;= $ac00 &amp;&amp; deord &lt;= $d7a3;
      if(complete) {
         var
            decho = (deord - $ac00) div 588,
            dejung = (deord - $ac00)%588 div 28,
            dejong = (deord - $ac00)%28;
         if(dejong) { // 종성
            for(var i = 0; i &lt; 12; i++)
               if(i == 11)
                  add = chr($ac00 + decho*588 + dejung*28);
               else if(cjong[i, 2] == dejong) { // 합자?
                  add = chr($ac00 + decho*588 + dejung*28 + cjong[i, 0]);
                  break;
               }
         } else for(var i = 0; i &lt; 8; i++) { // 중성
            if(i == 7)
               add = string_char_at(choseong, decho + 1);
            else if(cjung[i, 2] == dejung) { // 합자?
               add = chr($ac00 + decho*588 + cjung[i, 0]*28);
               break;
            }
         }
      } else
         imeSelected = false;
   }
   
   imeInput = string_delete(imeInput, string_length(imeInput), 1) + add;
}

for(var i = 37; i &lt; 41; i++)
   if(keyboard_check_pressed(i))
      imeSelected = false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_set_colour($ffffff);
draw_set_alpha(1);
draw_set_font(f_nanumgothic);
draw_set_halign(fa_left);
draw_set_valign(fa_top);

draw_text(8, 8, '한글 IME 테스트!');
if(imeSelected) {
   var
      l = string_length(imeInput),
      w = string_width(string_delete(imeInput, l, 1)),
      m = string_width(string_char_at(imeInput, l)),
      h = string_height(' ');
   draw_text(8, 32, string_delete(imeInput, string_length(imeInput), 1));
   draw_rectangle(8 + w, 32, 7 + w + m, 31 + h, false);
   draw_set_colour($000000);
   draw_text(8 + w, 32, string_char_at(imeInput, l));
} else
   draw_text(8, 32, imeInput);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
